# Настройка 2GIS MapGL API

## Получение API ключа

1. Перейдите на https://dev.2gis.com/
2. Зарегистрируйтесь или войдите в аккаунт
3. Создайте новый проект
4. Получите API ключ для JavaScript API

## Настройка проекта

### 1. Добавьте API ключ в `.env`

```bash
# 2GIS Map API Key
NEXT_PUBLIC_2GIS_API_KEY=your_api_key_here
```

### 2. Проверьте что ключ работает

Запустите dev сервер:
```bash
pnpm dev
```

Откройте `/map` страницу - карта должна загрузиться.

## Возможности 2GIS API

### Карты
- ✅ Высокодетализированные карты России, СНГ
- ✅ Реалтайм данные о пробках
- ✅ Информация о компаниях и организациях
- ✅ 3D здания (в некоторых городах)

### Геокодирование
- ✅ Прямое геокодирование (адрес → координаты)
- ✅ Обратное геокодирование (координаты → адрес)
- ✅ Поиск по названию

### Маршрутизация
- ✅ Построение маршрутов для авто, пешеходов, транспорта
- ✅ Учет пробок
- ✅ Альтернативные маршруты

### Поиск мест
- ✅ Catalog API для поиска организаций
- ✅ Фильтрация по категориям
- ✅ Детальная информация (часы работы, телефоны, отзывы)

## Используемые компоненты

### Map2GISView
Основная карта для отображения мест:
- Маркеры с emoji по категориям
- Клик на маркер для показа деталей
- Кнопка центрирования на пользователя

### Map2GISLocationPicker
Выбор стартовой точки маршрута:
- Клик на карту для выбора точки
- Автоопределение текущей позиции
- Обратное геокодирование через 2GIS API

### JourneyMap2GIS
Карта активного путешествия:
- Отображение маршрута полилинией
- Цветные маркеры (серый → синий → зеленый)
- Отслеживание позиции пользователя
- Автоцентрирование на текущей точке

### RouteMapView2GIS
Превью маршрута на странице деталей:
- Весь маршрут с линией
- Popup'ы при клике на точки
- Автоматический zoom для показа всего маршрута

## API Endpoints используемые в проекте

### Geocoder API
```
GET https://catalog.api.2gis.com/3.0/items/geocode?lat={lat}&lon={lon}&fields=items.point&key={apiKey}
```

Используется для получения адреса по координатам.

### Catalog API (для будущего)
```
GET https://catalog.api.2gis.com/3.0/items?q={query}&key={apiKey}
```

Можно использовать для поиска мест и организаций.

### Routing API (для будущего)
```
POST https://routing.api.2gis.com/get_directions?key={apiKey}
```

Для построения оптимальных маршрутов между точками.

## Ограничения

- **Rate Limit**: проверьте ваш тарифный план
- **География**: карты лучше всего работают для России и СНГ
- **Требуется API ключ**: без ключа карты не загрузятся

## Документация

- [2GIS MapGL JS API](https://docs.2gis.com/en/mapgl/overview)
- [Geocoder API](https://docs.2gis.com/en/api/search/geocoder/overview)
- [Catalog API](https://docs.2gis.com/en/api/search/places/overview)
- [Routing API](https://docs.2gis.com/en/api/navigation/directions/overview)
